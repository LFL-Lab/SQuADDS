
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial 7: Simulating Qiskit Metal design objects with palace using SQDMetal &#8212; SQuADDS v0.3.7</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=29d04658"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/katex.min.js?v=be8ff15f"></script>
    <script src="../../_static/auto-render.min.js?v=ad136472"></script>
    <script src="../../_static/katex_autorenderer.js?v=bebc588a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../../_static/squadds_logo_dark.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tutorial 8: Machine Learning with SQuADDS" href="Tutorial-8_ML_interpolation_in_SQuADDS.html" />
    <link rel="prev" title="Tutorial 6: Adding Airbridges" href="Tutorial-6_Adding_Airbridges.html" />
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-R5QKJDWM2W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-R5QKJDWM2W');
</script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">Read our <a href='https://quantum-journal.org/papers/q-2024-09-09-1465/'>paper</a></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="https://lfl-lab.github.io/SQuADDS/">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/squadds_logo_light_name.png" class="logo__image only-light" alt="SQuADDS Logo"/>
    <img src="../../_static/squadds_logo_dark_name.png" class="logo__image only-dark pst-js-only" alt="SQuADDS Logo"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../apidocs/index.html">
    Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../resources/contribute.html">
    Contributions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developer/index.html">
    Developer Notes
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../resources/simulations.html">
    Simulation Notes
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../resources/concepts.html">
    Workflows
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../release_notes.html">
    Release Logs
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../references/index.html">
    References
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/lfl-lab/SQuADDS">
    GitHub
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://arxiv.org/pdf/2312.13483.pdf">
    Paper
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://dornsife.usc.edu/lfl/">
    LFL Lab ✌️
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/LFL-Lab/SQuADDS" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/SQuADDS/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://huggingface.co/datasets/SQuADDS/SQuADDS_DB" title="HuggingFace" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-face-smile fa-lg" aria-hidden="true"></i>
            <span class="sr-only">HuggingFace</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://deepwiki.com/LFL-Lab/SQuADDS" title="DeepWiki" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-robot fa-lg" aria-hidden="true"></i>
            <span class="sr-only">DeepWiki</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../apidocs/index.html">
    Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../resources/contribute.html">
    Contributions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developer/index.html">
    Developer Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../resources/simulations.html">
    Simulation Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../resources/concepts.html">
    Workflows
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../release_notes.html">
    Release Logs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../references/index.html">
    References
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/lfl-lab/SQuADDS">
    GitHub
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://arxiv.org/pdf/2312.13483.pdf">
    Paper
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://dornsife.usc.edu/lfl/">
    LFL Lab ✌️
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/LFL-Lab/SQuADDS" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/SQuADDS/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://huggingface.co/datasets/SQuADDS/SQuADDS_DB" title="HuggingFace" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-face-smile fa-lg" aria-hidden="true"></i>
            <span class="sr-only">HuggingFace</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://deepwiki.com/LFL-Lab/SQuADDS" title="DeepWiki" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-robot fa-lg" aria-hidden="true"></i>
            <span class="sr-only">DeepWiki</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tutorial-0_Using_the_SQuADDS_WebUI.html">Tutorial 0: Using the SQuADDS Web UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial-1_Getting_Started_with_SQuADDS.html">Tutorial 1: Getting Started with SQuADDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial-2_Simulate_interpolated_designs.html">Tutorial 2: Simulating Interpolated Designs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial-3_Contributing_Validated_Simulation_Data_to_SQuADDS.html">Tutorial 3: Contributing Experimentally Validated Simulation Data to SQuADDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_4_Contributing_Measured_Data_to_SQuADDS.html">Tutorial 4: Contributing Measured Devices’ Data to the SQuADDS Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial-5_Designing_a_fab_ready_chip_with_SQuADDS.html">Tutorial 5: Designing a “fab-ready” chip with <code class="docutils literal notranslate"><span class="pre">SQuADDS</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial-6_Adding_Airbridges.html">Tutorial 6: Adding Airbridges</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Tutorial 7: Simulating Qiskit Metal <code class="docutils literal notranslate"><span class="pre">design</span></code> objects with <code class="docutils literal notranslate"><span class="pre">palace</span></code> using <code class="docutils literal notranslate"><span class="pre">SQDMetal</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial-8_ML_interpolation_in_SQuADDS.html">Tutorial 8: Machine Learning with <code class="docutils literal notranslate"><span class="pre">SQuADDS</span></code></a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Tutorial 7: Simulating Qiskit Metal <code class="docutils literal notranslate"><span class="pre">design</span></code> objects with <code class="docutils literal notranslate"><span class="pre">palace</span></code> using <code class="docutils literal notranslate"><span class="pre">SQDMetal</span></code></span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Tutorial-7:-Simulating-Qiskit-Metal-design-objects-with-palace-using-SQDMetal">
<h1>Tutorial 7: Simulating Qiskit Metal <code class="docutils literal notranslate"><span class="pre">design</span></code> objects with <code class="docutils literal notranslate"><span class="pre">palace</span></code> using <code class="docutils literal notranslate"><span class="pre">SQDMetal</span></code><a class="headerlink" href="#Tutorial-7:-Simulating-Qiskit-Metal-design-objects-with-palace-using-SQDMetal" title="Link to this heading">#</a></h1>
<p>In this tutorial, we will cover how to do electrostatic and eigenmode simulations of a qubit-cavity system using <code class="docutils literal notranslate"><span class="pre">palace</span></code>.</p>
<p><strong>Requirements:</strong></p>
<ul class="simple">
<li><p>☐ Ensure that <a class="reference external" href="https://github.com/sqdlab/SQDMetal">SQDMetal</a> is installed in your environment.</p></li>
<li><p>☐ Ensure that <a class="reference external" href="https://github.com/awslabs/palace">palace</a> is installed in your environment. Instructions <a class="reference external" href="https://lfl-lab.github.io/SQuADDS/source/resources/palace.html">here</a>.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;KMP_DUPLICATE_LIB_OK&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;TRUE&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PMIX_MCA_gds&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;hash&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;sims&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Define the path to the <code class="docutils literal notranslate"><span class="pre">palace</span></code> executable</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path_to_palace</span> <span class="o">=</span> <span class="s1">&#39;/Users/shanto/LFL/palace/build/bin/palace&#39;</span>
</pre></div>
</div>
</div>
<section id="Electrostatic-Simulation">
<h2>Electrostatic Simulation<a class="headerlink" href="#Electrostatic-Simulation" title="Link to this heading">#</a></h2>
<p>We will be learning how to extract the capacitance matrix from an electrostatic simulation.</p>
<section id="For-a-qubit-claw-system">
<h3>For a qubit-claw system<a class="headerlink" href="#For-a-qubit-claw-system" title="Link to this heading">#</a></h3>
<p>Importing the relevant modules</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">qiskit_metal</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">metal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal</span><span class="w"> </span><span class="kn">import</span> <span class="n">designs</span><span class="p">,</span> <span class="n">draw</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetalGUI</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">open_docs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.toolbox_metal</span><span class="w"> </span><span class="kn">import</span> <span class="n">math_and_overrides</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">QComponent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.tlines.meandered</span><span class="w"> </span><span class="kn">import</span> <span class="n">RouteMeander</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.tlines.straight_path</span><span class="w"> </span><span class="kn">import</span> <span class="n">RouteStraight</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.tlines.pathfinder</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoutePathfinder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.terminations.launchpad_wb</span><span class="w"> </span><span class="kn">import</span> <span class="n">LaunchpadWirebond</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.terminations.open_to_ground</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenToGround</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.terminations.short_to_ground</span><span class="w"> </span><span class="kn">import</span> <span class="n">ShortToGround</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.couplers.coupled_line_tee</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoupledLineTee</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.qubits.transmon_cross</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransmonCross</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
<p>We want to get the cap matrix for a system with TransmonCross, claw and ground (similar to the simulations we ran to build <code class="docutils literal notranslate"><span class="pre">SQuADDS_DB</span></code>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">squadds</span><span class="w"> </span><span class="kn">import</span> <span class="n">SQuADDS_DB</span><span class="p">,</span> <span class="n">Analyzer</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FutureWarning: Module &#39;pyaedt&#39; has become an alias to the new package structure. Please update you imports to use the new architecture based on &#39;ansys.aedt.core&#39;. In addition, some files have been renamed to follow the PEP 8 naming convention. The old structure and file names will be deprecated in future versions, see https://aedt.docs.pyansys.com/version/stable/release_1_0.html
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, get a design from SQuADDS</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQuADDS_DB</span><span class="p">()</span>
<span class="n">db</span><span class="o">.</span><span class="n">select_system</span><span class="p">(</span><span class="s2">&quot;qubit&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">select_qubit</span><span class="p">(</span><span class="s2">&quot;TransmonCross&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">create_system_df</span><span class="p">()</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">Analyzer</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>

<span class="c1"># Define target parameters for your qubit</span>
<span class="n">target_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;qubit_frequency_GHz&quot;</span><span class="p">:</span> <span class="mf">4.2</span><span class="p">,</span>  <span class="c1"># Example value</span>
    <span class="s2">&quot;anharmonicity_MHz&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">200</span>    <span class="c1"># Example value</span>
<span class="p">}</span>

<span class="c1"># Find the closest design</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">find_closest</span><span class="p">(</span><span class="n">target_params</span><span class="p">,</span> <span class="n">num_top</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">best_device</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Get the design options</span>
<span class="n">qubit_options</span> <span class="o">=</span> <span class="n">best_device</span><span class="p">[</span><span class="s2">&quot;design_options&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up chip design as planar</span>
<span class="n">design</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">DesignPlanar</span><span class="p">({},</span> <span class="n">overwrite_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># Create GUI</span>
<span class="n">gui</span> <span class="o">=</span> <span class="n">MetalGUI</span><span class="p">(</span><span class="n">design</span><span class="p">)</span>

<span class="c1"># Qubit and a claw</span>
<span class="c1"># Create the TransmonCross object with the modified options</span>
<span class="c1"># Update only the position parameters</span>
<span class="n">qubit_options</span><span class="p">[</span><span class="s2">&quot;pos_x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0.6075mm&#39;</span>
<span class="n">qubit_options</span><span class="p">[</span><span class="s2">&quot;pos_y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-1.464&#39;</span>
<span class="n">Q1</span> <span class="o">=</span> <span class="n">TransmonCross</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">qubit_options</span><span class="p">)</span>

<span class="n">gui</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="n">design</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="s1">&#39;sims/qubit.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
06:30PM 33s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  WARNING: Populating font family aliases took 256 ms. Replace uses of missing font family &#34;Courier&#34; with one that exists to avoid this cost.

06:30PM 33s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf675061c0; contentView=&lt;QNSView: 0x7faf901effc0; QCocoaWindow(0x7faf901e75e0, window=QWidgetWindow(0x7faf650d1460, name=&#34;MainWindowPlotWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

06:30PM 33s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf902cdd30; contentView=&lt;QNSView: 0x7faf902cd590; QCocoaWindow(0x7faf902cd480, window=QWidgetWindow(0x7faf902ccf00, name=&#34;ElementsWindowWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

06:30PM 33s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf902a85f0; contentView=&lt;QNSView: 0x7faf902a7c10; QCocoaWindow(0x7faf902a7b00, window=QWidgetWindow(0x7faf902a7890, name=&#34;MainWindowWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

06:30PM 33s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf90325990; contentView=&lt;QNSView: 0x7faf903251f0; QCocoaWindow(0x7faf903250e0, window=QWidgetWindow(0x7faf90324b80, name=&#34;NetListWindowWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/source_tutorials_Tutorial-7_Simulate_designs_with_palace_12_1.png" class="no-scaled-link" src="../../_images/source_tutorials_Tutorial-7_Simulate_designs_with_palace_12_1.png" style="width: 500px;" />
</div>
</div>
<p>Call the <code class="docutils literal notranslate"><span class="pre">SQDMetal</span></code> objects. Change the hyper-parameters as needed for a more accurate simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">SQDMetal.PALACE.Capacitance_Simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">PALACE_Capacitance_Simulation</span>

<span class="n">user_defined_options</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;mesh_refinement&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>                             <span class="c1">#refines mesh in PALACE - essetially divides every mesh element in half</span>
                <span class="s2">&quot;dielectric_material&quot;</span><span class="p">:</span> <span class="s2">&quot;silicon&quot;</span><span class="p">,</span>                  <span class="c1">#choose dielectric material - &#39;silicon&#39; or &#39;sapphire&#39;</span>
                <span class="s2">&quot;solver_order&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>                                 <span class="c1">#increasing solver order increases accuracy of simulation, but significantly increases sim time</span>
                <span class="s2">&quot;solver_tol&quot;</span><span class="p">:</span> <span class="mf">1.0e-8</span><span class="p">,</span>                              <span class="c1">#error residual tolerance for iterative solver</span>
                <span class="s2">&quot;solver_maxits&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>                              <span class="c1">#number of solver iterations</span>
                <span class="s2">&quot;mesh_max&quot;</span><span class="p">:</span> <span class="mf">120e-6</span><span class="p">,</span>                                <span class="c1">#maxiumum element size for the mesh in mm</span>
                <span class="s2">&quot;mesh_sampling&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>                              <span class="c1">#number of points to mesh along a geometry</span>
                <span class="s2">&quot;fillet_resolution&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span>                            <span class="c1">#number of vertices per quarter turn on a filleted path</span>
                <span class="s2">&quot;num_cpus&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>                                      <span class="c1">#number of CPU cores to use for simulation</span>
                <span class="s2">&quot;palace_dir&quot;</span><span class="p">:</span><span class="n">path_to_palace</span>
                <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Creat the Palace Eigenmode simulation</span>
<span class="n">cap_sim</span> <span class="o">=</span> <span class="n">PALACE_Capacitance_Simulation</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;transmon_cross_cap_sim&#39;</span><span class="p">,</span>                                 <span class="c1">#name of simulation</span>
                                        <span class="n">metal_design</span> <span class="o">=</span> <span class="n">design</span><span class="p">,</span>                                      <span class="c1">#feed in qiskit metal design</span>
                                        <span class="n">sim_parent_directory</span> <span class="o">=</span> <span class="s2">&quot;sims/&quot;</span><span class="p">,</span>            <span class="c1">#choose directory where mesh file, config file and HPC batch file will be saved</span>
                                        <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;simPC&#39;</span><span class="p">,</span>                                             <span class="c1">#choose simulation mode &#39;HPC&#39; or &#39;simPC&#39;</span>
                                        <span class="n">meshing</span> <span class="o">=</span> <span class="s1">&#39;GMSH&#39;</span><span class="p">,</span>                                           <span class="c1">#choose meshing &#39;GMSH&#39; or &#39;COMSOL&#39;</span>
                                        <span class="n">user_options</span> <span class="o">=</span> <span class="n">user_defined_options</span><span class="p">,</span>                        <span class="c1">#provide options chosen above</span>
                                        <span class="n">view_design_gmsh_gui</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>                               <span class="c1">#view design in GMSH gui</span>
                                        <span class="n">create_files</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                        <span class="p">)</span>                                        <span class="c1">#create mesh, config and HPC batch files</span>

<span class="n">cap_sim</span><span class="o">.</span><span class="n">add_metallic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="n">fuse_threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="n">cap_sim</span><span class="o">.</span><span class="n">add_ground_plane</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<p>To generate a fine mesh around our region of interest, we can use the <code class="docutils literal notranslate"><span class="pre">fine_mesh_in_rectangle</span></code> method by first getting the bounds of the region of interest.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="n">design</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="s2">&quot;Q1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">qgeometry_bounds</span><span class="p">()</span>
<span class="n">bounds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0.3675, -1.704 ,  0.9277, -1.224 ])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fine-mesh the transmon cross qubit region</span>
<span class="n">cap_sim</span><span class="o">.</span><span class="n">fine_mesh_in_rectangle</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">mesh_sampling</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">mesh_min</span><span class="o">=</span><span class="mf">10e-3</span><span class="p">,</span> <span class="n">mesh_max</span><span class="o">=</span><span class="mf">125e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap_sim</span><span class="o">.</span><span class="n">prepare_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>You can check to see if all the metal components are correctly identified</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap_sim</span><span class="o">.</span><span class="n">display_conductor_indices</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/source_tutorials_Tutorial-7_Simulate_designs_with_palace_21_0.svg" src="../../_images/source_tutorials_Tutorial-7_Simulate_designs_with_palace_21_0.svg" />
</div>
</div>
<p>Similarly, you can verify the mesh is correct by visualizing the mesh</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">SQDMetal.PALACE.Utilities.GMSH_Navigator</span><span class="w"> </span><span class="kn">import</span> <span class="n">GMSH_Navigator</span>

<span class="n">gmsh_nav</span> <span class="o">=</span> <span class="n">GMSH_Navigator</span><span class="p">(</span><span class="n">cap_sim</span><span class="o">.</span><span class="n">path_mesh</span><span class="p">)</span>
<span class="n">gmsh_nav</span><span class="o">.</span><span class="n">open_GUI</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>If all looks good, you can run the simulation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap_matrix</span> <span class="o">=</span><span class="n">cap_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt;&gt; /opt/homebrew/bin/mpirun -n 10 /Users/shanto/LFL/palace/build/bin/palace-arm64.bin xmon_cap_sim_GMSH.json

_____________     _______
_____   __   \____ __   /____ ____________
____   /_/  /  __ ` /  /  __ ` /  ___/  _ \
___   _____/  /_/  /  /  /_/  /  /__/  ___/
  /__/     \___,__/__/\___,__/\_____\_____/

Git changeset ID: v0.13.0-117-g748660c
Running with 10 MPI processes
Device configuration: cpu
Memory configuration: host-std
libCEED backend: /cpu/self/xsmm/blocked

Added 369 elements in 2 iterations of local bisection for under-resolved interior boundaries
Added 7772 duplicate vertices for interior boundaries in the mesh
Added 16409 duplicate boundary elements for interior boundaries in the mesh
Added 4040 boundary elements for material interfaces to the mesh
Finished partitioning mesh into 10 subdomains

Characteristic length and time scales:
 L₀ = 1.080e-02 m, t₀ = 3.602e-02 ns

Mesh curvature order: 1
Mesh bounding box:
 (Xmin, Ymin, Zmin) = (-5.400e-03, -3.600e-03, -7.500e-04) m
 (Xmax, Ymax, Zmax) = (+5.400e-03, +3.600e-03, +7.500e-04) m

Parallel Mesh Stats:

                minimum     average     maximum       total
 vertices          7422        7920        8388       79201
 edges            48320       49915       51242      499150
 faces            79214       80632       81980      806329
 elements         38316       38637       39385      386378
 neighbors            2           4           7

            minimum     maximum
 h      0.000552426   0.0217216
 kappa      1.01738     11.1252

Configuring Dirichlet BC at attributes:
 7, 1-3

Assembling system matrices, number of global unknowns:
 H1 (p = 1): 79201, ND (p = 1): 499150, RT (p = 1): 806329
 Operator assembly level: Partial
 Mesh geometries:
  Tetrahedron: P = 6, Q = 4 (quadrature order = 2)

Assembling multigrid hierarchy:
 Level 0 (p = 1): 79201 unknowns, 1105237 NNZ

Computing electrostatic fields for 3 terminal boundaries

It 1/3: Index = 1 (elapsed time = 0.00e+00 s)

  Residual norms for PCG solve
  0 KSP residual norm ||r||_B = 1.990521e+01
  1 KSP residual norm ||r||_B = 1.819635e+00
  2 KSP residual norm ||r||_B = 2.004853e-01
  3 KSP residual norm ||r||_B = 3.448215e-02
  4 KSP residual norm ||r||_B = 5.786581e-03
  5 KSP residual norm ||r||_B = 9.102787e-04
  6 KSP residual norm ||r||_B = 1.491365e-04
  7 KSP residual norm ||r||_B = 2.723162e-05
  8 KSP residual norm ||r||_B = 4.884593e-06
  9 KSP residual norm ||r||_B = 8.463240e-07
PCG solver converged in 9 iterations (avg. reduction factor: 1.236e-01)
 Sol. ||V|| = 1.770460e+02 (||RHS|| = 1.249420e+02)
 Field energy E = 1.624e+00 J
 Updating solution error estimates
 Wrote fields to disk for terminal 1

It 2/3: Index = 2 (elapsed time = 2.28e+00 s)

  Residual norms for PCG solve
  0 KSP residual norm ||r||_B = 8.173841e-01
  1 KSP residual norm ||r||_B = 8.983963e-02
  2 KSP residual norm ||r||_B = 1.454760e-02
  3 KSP residual norm ||r||_B = 2.128182e-03
  4 KSP residual norm ||r||_B = 3.333766e-04
  5 KSP residual norm ||r||_B = 6.577703e-05
  6 KSP residual norm ||r||_B = 1.180018e-05
  7 KSP residual norm ||r||_B = 1.987690e-06
  8 KSP residual norm ||r||_B = 3.601812e-07
  9 KSP residual norm ||r||_B = 6.149758e-08
PCG solver converged in 9 iterations (avg. reduction factor: 1.164e-01)
 Sol. ||V|| = 1.812398e+01 (||RHS|| = 1.571719e+01)
 Field energy E = 4.756e-02 J
 Updating solution error estimates
 Wrote fields to disk for terminal 2

It 3/3: Index = 3 (elapsed time = 4.44e+00 s)

  Residual norms for PCG solve
  0 KSP residual norm ||r||_B = 1.826447e+00
  1 KSP residual norm ||r||_B = 2.466585e-01
  2 KSP residual norm ||r||_B = 4.728945e-02
  3 KSP residual norm ||r||_B = 7.134869e-03
  4 KSP residual norm ||r||_B = 1.244552e-03
  5 KSP residual norm ||r||_B = 2.185094e-04
  6 KSP residual norm ||r||_B = 3.939749e-05
  7 KSP residual norm ||r||_B = 7.145503e-06
  8 KSP residual norm ||r||_B = 1.180785e-06
  9 KSP residual norm ||r||_B = 2.068803e-07
PCG solver converged in 9 iterations (avg. reduction factor: 1.260e-01)
 Sol. ||V|| = 3.791320e+01 (||RHS|| = 2.584766e+01)
 Field energy E = 2.559e-02 J
 Updating solution error estimates
 Wrote fields to disk for terminal 3

Completed 0 iterations of adaptive mesh refinement (AMR):
 Indicator norm = 5.098e-01, global unknowns = 79201
 Max. iterations = 0, tol. = 1.000e-02

Elapsed Time Report (s)           Min.        Max.        Avg.
==============================================================
Initialization                   7.757       7.764       7.759
Operator Construction            0.524       0.563       0.543
Linear Solve                     0.232       0.285       0.256
  Setup                          0.018       0.020       0.019
  Preconditioner                 0.650       0.693       0.668
Estimation                       0.098       0.139       0.122
  Construction                   3.891       3.893       3.891
  Solve                          2.377       2.378       2.378
Postprocessing                   0.502       0.538       0.519
Disk IO                          4.983       5.007       4.994
--------------------------------------------------------------
Total                           21.210      21.233      21.227

Error in plotting: &#39;Data array (V) not present in this dataset.&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cap_matrix</span><span class="p">)</span>

<span class="c1"># get rid of the first column</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

<span class="c1"># assigning the columns and indices based on our geometry</span>
<span class="n">cdf</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span> <span class="s2">&quot;claw&quot;</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">]</span>
<span class="n">cdf</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ground&quot;</span><span class="p">,</span> <span class="s2">&quot;claw&quot;</span><span class="p">,</span> <span class="s2">&quot;cross&quot;</span><span class="p">]</span>
<span class="n">cdf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ground</th>
      <th>claw</th>
      <th>cross</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ground</th>
      <td>8.621504e-12</td>
      <td>-2.458660e-13</td>
      <td>-1.239444e-13</td>
    </tr>
    <tr>
      <th>claw</th>
      <td>-2.458660e-13</td>
      <td>2.524815e-13</td>
      <td>-4.830456e-15</td>
    </tr>
    <tr>
      <th>cross</th>
      <td>-1.239444e-13</td>
      <td>-4.830456e-15</td>
      <td>1.358696e-13</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The above dataframe is the capacitance matrix for our system in Farads.</p>
<p>To get a more accurate result - consider a higher order solver and a finer mesh.</p>
<hr class="docutils" />
</section>
</section>
<section id="Eigenmodal-Simulation">
<h2>Eigenmodal Simulation<a class="headerlink" href="#Eigenmodal-Simulation" title="Link to this heading">#</a></h2>
<section id="For-a-qubit-cavity-system">
<h3>For a qubit-cavity system<a class="headerlink" href="#For-a-qubit-cavity-system" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import useful packages</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qiskit_metal</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">metal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal</span><span class="w"> </span><span class="kn">import</span> <span class="n">designs</span><span class="p">,</span> <span class="n">draw</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetalGUI</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">open_docs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.toolbox_metal</span><span class="w"> </span><span class="kn">import</span> <span class="n">math_and_overrides</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">QComponent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">squadds.components.qubits</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransmonCross</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.tlines.meandered</span><span class="w"> </span><span class="kn">import</span> <span class="n">RouteMeander</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.tlines.straight_path</span><span class="w"> </span><span class="kn">import</span> <span class="n">RouteStraight</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.tlines.pathfinder</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoutePathfinder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.terminations.launchpad_wb</span><span class="w"> </span><span class="kn">import</span> <span class="n">LaunchpadWirebond</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.terminations.open_to_ground</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenToGround</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.terminations.short_to_ground</span><span class="w"> </span><span class="kn">import</span> <span class="n">ShortToGround</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_metal.qlibrary.couplers.coupled_line_tee</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoupledLineTee</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
<p>For this example lets use an example geometry from <a class="reference external" href="https://lfl-lab.github.io/SQuADDS/source/tutorials/Tutorial-5_Designing_a_fab_ready_chip_with_SQuADDS.html#Making-the-Design">Tutorial 5</a> and build the design with <code class="docutils literal notranslate"><span class="pre">SQDMetal</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">unselect_all</span><span class="p">()</span>
<span class="n">db</span><span class="o">.</span><span class="n">select_system</span><span class="p">([</span><span class="s2">&quot;cavity_claw&quot;</span><span class="p">,</span> <span class="s2">&quot;qubit&quot;</span><span class="p">])</span>
<span class="n">db</span><span class="o">.</span><span class="n">select_qubit</span><span class="p">(</span><span class="s2">&quot;TransmonCross&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">select_cavity_claw</span><span class="p">(</span><span class="s2">&quot;RouteMeander&quot;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">select_resonator_type</span><span class="p">(</span><span class="s2">&quot;quarter&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">create_system_df</span><span class="p">()</span>

<span class="n">analyzer</span><span class="o">.</span><span class="n">reload_db</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a654eff46b434f768709ce7d6eb6a9d9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;qubit_frequency_GHz&quot;</span><span class="p">:</span> <span class="mf">3.7</span><span class="p">,</span>
                <span class="s2">&quot;resonator_type&quot;</span><span class="p">:</span><span class="s2">&quot;quarter&quot;</span><span class="p">,</span>
                <span class="s2">&quot;anharmonicity_MHz&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">210</span><span class="p">,</span>
                <span class="s2">&quot;g_MHz&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="c1"># should provide a big punchout shift</span>
                <span class="p">}</span>

<span class="c1"># computing the cavity frequency desired as per the design requirements</span>
<span class="n">target_params</span><span class="p">[</span><span class="s2">&quot;cavity_frequency_GHz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">target_params</span><span class="p">[</span><span class="s2">&quot;qubit_frequency_GHz&quot;</span><span class="p">]</span><span class="o">+</span><span class="n">target_params</span><span class="p">[</span><span class="s2">&quot;anharmonicity_MHz&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">find_closest</span><span class="p">(</span><span class="n">target_params</span><span class="o">=</span><span class="n">target_params</span><span class="p">,</span><span class="n">num_top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;Euclidean&quot;</span><span class="p">)</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time taken to add the coupled H params: 4.370030879974365 seconds
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index_qc</th>
      <th>PI_qubit</th>
      <th>date_created_qubit</th>
      <th>group_qubit</th>
      <th>institution_qubit</th>
      <th>uploader_qubit</th>
      <th>renderer_options_qubit</th>
      <th>setup_qubit</th>
      <th>simulator_qubit</th>
      <th>claw_to_claw</th>
      <th>...</th>
      <th>coupler_type</th>
      <th>design_options_cavity_claw</th>
      <th>design_tool_cavity_claw</th>
      <th>resonator_type</th>
      <th>design_options</th>
      <th>EC</th>
      <th>EJ</th>
      <th>qubit_frequency_GHz</th>
      <th>anharmonicity_MHz</th>
      <th>g_MHz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12514</th>
      <td>1900</td>
      <td>Eli Levenson-Falk, PhD</td>
      <td>2023-09-20-142549</td>
      <td>LFL</td>
      <td>USC</td>
      <td>Andre Kuo</td>
      <td>{'Cj': 0, 'Lj': '10nH', '_Rj': 0, 'design_name...</td>
      <td>{'auto_increase_solution_order': True, 'enable...</td>
      <td>Ansys HFSS</td>
      <td>102.50358</td>
      <td>...</td>
      <td>CLT</td>
      <td>{'claw_opts': {'connection_pads': {'readout': ...</td>
      <td>qiskit-metal</td>
      <td>quarter</td>
      <td>{'cavity_claw_options': {'coupler_type': 'CLT'...</td>
      <td>0.180488</td>
      <td>10.278024</td>
      <td>3.66213</td>
      <td>-205.109839</td>
      <td>98.903433</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 41 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_qubit</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_qubit_options</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">data_cpw</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_cpw_options</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">data_coupler</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_coupler_options</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">LJs</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_Ljs</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="c1"># in nH</span>
</pre></div>
</div>
</div>
<p>Creating a new <code class="docutils literal notranslate"><span class="pre">design</span></code> and <code class="docutils literal notranslate"><span class="pre">gui</span></code> object since we are running this in the same notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First delete components</span>
<span class="n">design</span><span class="o">.</span><span class="n">delete_all_components</span><span class="p">()</span>

<span class="c1"># Close the GUI</span>
<span class="n">gui</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Forced garbage collection</span>
<span class="n">gui</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">design</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">design</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">DesignPlanar</span><span class="p">({},</span> <span class="n">overwrite_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gui</span> <span class="o">=</span> <span class="n">MetalGUI</span><span class="p">(</span><span class="n">design</span><span class="p">)</span>


<span class="c1"># Set up chip dimensions</span>
<span class="n">design</span><span class="o">.</span><span class="n">chips</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">size_x</span> <span class="o">=</span> <span class="s1">&#39;4.6mm&#39;</span>
<span class="n">design</span><span class="o">.</span><span class="n">chips</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">size_y</span> <span class="o">=</span> <span class="s1">&#39;2.4mm&#39;</span>
<span class="n">design</span><span class="o">.</span><span class="n">chips</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">size_z</span> <span class="o">=</span> <span class="s1">&#39;-280um&#39;</span>
<span class="n">design</span><span class="o">.</span><span class="n">chips</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">center_x</span> <span class="o">=</span> <span class="s1">&#39;0mm&#39;</span>
<span class="n">design</span><span class="o">.</span><span class="n">chips</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">center_y</span> <span class="o">=</span> <span class="s1">&#39;-1mm&#39;</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
06:31PM 38s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf63991d30; contentView=&lt;QNSView: 0x7faf63991690; QCocoaWindow(0x7faf63991580, window=QWidgetWindow(0x7faf6398e990, name=&#34;MainWindowPlotWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

06:31PM 38s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf44069cb0; contentView=&lt;QNSView: 0x7faf440698d0; QCocoaWindow(0x7faf440697c0, window=QWidgetWindow(0x7faf440692a0, name=&#34;ElementsWindowWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

06:31PM 38s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf66f2c980; contentView=&lt;QNSView: 0x7faf66f2c2a0; QCocoaWindow(0x7faf66f2c190, window=QWidgetWindow(0x7faf66f2bcf0, name=&#34;MainWindowWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

06:31PM 38s CRITICAL [_qt_message_handler]: line: 0, func: None(), file: None  CRITICAL: &lt;QNSWindow: 0x7faf66f3e720; contentView=&lt;QNSView: 0x7faf66f3e080; QCocoaWindow(0x7faf66f3df70, window=QWidgetWindow(0x7faf66f3da50, name=&#34;NetListWindowWindow&#34;))&gt;&gt; has active key-value observers (KVO)! These will stop working now that the window is recreated, and will result in exceptions when the observers are removed. Break in QCocoaWindow::recreateWindowIfNeeded to debug.

</pre></div></div>
</div>
<p>Lets create the qubit with a junction and a claw</p>
<section id="Qubit-(with-a-junction)-and-Claw">
<h4>Qubit (with a junction) and Claw<a class="headerlink" href="#Qubit-(with-a-junction)-and-Claw" title="Link to this heading">#</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">SQDMetal.Comps.Xmon</span><span class="w"> </span><span class="kn">import</span> <span class="n">Xmon</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">SQDMetal.Comps.Junctions</span><span class="w"> </span><span class="kn">import</span> <span class="n">JunctionDolanPinStretch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">SQDMetal.Comps.Capacitors</span><span class="w"> </span><span class="kn">import</span> <span class="n">CapacitorProngPin</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate vBar_gap and hBar_gap</span>
<span class="k">def</span><span class="w"> </span><span class="nf">extract_um</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract float from &#39;30um&#39;.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;um&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>

<span class="c1"># Unpack parameters from data_qubit</span>
<span class="n">cross_width</span> <span class="o">=</span> <span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_width&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cross_length</span> <span class="o">=</span> <span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_length&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cross_gap</span> <span class="o">=</span> <span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Now create the Xmon</span>
<span class="n">xmon</span> <span class="o">=</span> <span class="n">Xmon</span><span class="p">(</span>
    <span class="n">design</span><span class="p">,</span>
    <span class="s1">&#39;xmon&#39;</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">pos_x</span> <span class="o">=</span> <span class="s1">&#39;0.375mm&#39;</span><span class="p">,</span>
        <span class="n">pos_y</span> <span class="o">=</span> <span class="s1">&#39;-1.3&#39;</span><span class="p">,</span>
        <span class="n">hBar_width</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cross_width</span><span class="si">}</span><span class="s2">um&quot;</span><span class="p">,</span>
        <span class="n">vBar_width</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cross_width</span><span class="si">}</span><span class="s2">um&quot;</span><span class="p">,</span>
        <span class="n">vBar_gap</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cross_gap</span><span class="si">}</span><span class="s2">um&quot;</span><span class="p">,</span>
        <span class="n">hBar_gap</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cross_gap</span><span class="si">}</span><span class="s2">um&quot;</span><span class="p">,</span>
        <span class="n">cross_width</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">cross_length</span><span class="si">}</span><span class="s2">um&quot;</span><span class="p">,</span>
        <span class="n">cross_height</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">cross_length</span><span class="si">}</span><span class="s2">um&quot;</span><span class="p">,</span>
        <span class="n">gap_up</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">gap_left</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">gap_right</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">gap_down</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Claw</span>
<span class="n">prong_length</span> <span class="o">=</span> <span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;claw_length&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;claw_width&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pin_gap_side</span> <span class="o">=</span> <span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;claw_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">extract_um</span><span class="p">(</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;ground_spacing&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">claw</span> <span class="o">=</span> <span class="n">CapacitorProngPin</span><span class="p">(</span>
    <span class="n">design</span><span class="p">,</span>
    <span class="s1">&#39;claw&#39;</span><span class="p">,</span>
    <span class="n">options</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">pin_inputs</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">start_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;xmon&#39;</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span><span class="s1">&#39;up&#39;</span><span class="p">)),</span>
        <span class="n">prong_width</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;claw_width&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">pad_thickness</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;claw_width&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">gap_front</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">gap_back</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;claw_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">gap_side</span> <span class="o">=</span> <span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;claw_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">prong_length</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prong_length</span><span class="si">}</span><span class="s2">um&quot;</span><span class="p">,</span>
        <span class="n">pin_gap_side</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pin_gap_side</span><span class="si">}</span><span class="s2">um&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Junction</span>
<span class="n">junction</span> <span class="o">=</span> <span class="n">JunctionDolanPinStretch</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;junction&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">pin_inputs</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">start_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;xmon&#39;</span><span class="p">,</span><span class="n">pin</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)),</span>
                                                         <span class="n">dist_extend</span><span class="o">=</span><span class="n">data_qubit</span><span class="p">[</span><span class="s1">&#39;cross_gap&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                                         <span class="n">layer</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                         <span class="n">finger_width</span><span class="o">=</span><span class="s1">&#39;0.4um&#39;</span><span class="p">,</span> <span class="n">t_pad_size</span><span class="o">=</span><span class="s1">&#39;0.385um&#39;</span><span class="p">,</span>
                                                         <span class="n">squid_width</span><span class="o">=</span><span class="s1">&#39;5.4um&#39;</span><span class="p">,</span> <span class="n">prong_width</span><span class="o">=</span><span class="s1">&#39;0.9um&#39;</span><span class="p">))</span>
<br/><br/></pre></div>
</div>
</div>
</section>
<section id="Resonator-and-Feedline">
<h4>Resonator and Feedline<a class="headerlink" href="#Resonator-and-Feedline" title="Link to this heading">#</a></h4>
<p>Now lets add the resonator and feedline</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lauchpad 1</span>
<span class="n">x1</span> <span class="o">=</span> <span class="s1">&#39;-2mm&#39;</span>
<span class="n">y1</span> <span class="o">=</span> <span class="s1">&#39;0mm&#39;</span>
<span class="n">launch_options1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">chip</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">pos_x</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">pos_y</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;360&#39;</span><span class="p">,</span> <span class="n">lead_length</span><span class="o">=</span><span class="s1">&#39;30um&#39;</span><span class="p">,</span> <span class="n">pad_height</span><span class="o">=</span><span class="s1">&#39;103um&#39;</span><span class="p">,</span>
                      <span class="n">pad_width</span><span class="o">=</span><span class="s1">&#39;103um&#39;</span><span class="p">,</span> <span class="n">pad_gap</span><span class="o">=</span><span class="s1">&#39;60um&#39;</span><span class="p">,</span> <span class="n">trace_width</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_width&quot;</span><span class="p">],</span> <span class="n">trace_gap</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_gap&quot;</span><span class="p">])</span>
<span class="n">LP1</span> <span class="o">=</span> <span class="n">LaunchpadWirebond</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;LP1&#39;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="n">launch_options1</span><span class="p">)</span>

<span class="c1"># Launchpad 2</span>
<span class="n">x2</span> <span class="o">=</span> <span class="s1">&#39;2mm&#39;</span>
<span class="n">y1</span> <span class="o">=</span> <span class="s1">&#39;0mm&#39;</span>
<span class="n">launch_options2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">chip</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">pos_x</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span> <span class="n">pos_y</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;180&#39;</span><span class="p">,</span> <span class="n">lead_length</span><span class="o">=</span><span class="s1">&#39;30um&#39;</span><span class="p">,</span> <span class="n">pad_height</span><span class="o">=</span><span class="s1">&#39;103um&#39;</span><span class="p">,</span>
                      <span class="n">pad_width</span><span class="o">=</span><span class="s1">&#39;103um&#39;</span><span class="p">,</span> <span class="n">pad_gap</span><span class="o">=</span><span class="s1">&#39;60um&#39;</span><span class="p">,</span> <span class="n">trace_width</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_width&quot;</span><span class="p">],</span> <span class="n">trace_gap</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_gap&quot;</span><span class="p">])</span>
<span class="n">LP2</span> <span class="o">=</span> <span class="n">LaunchpadWirebond</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;LP2&#39;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="n">launch_options2</span><span class="p">)</span>

<span class="c1"># Using path finder to connect the two launchpads</span>
<span class="n">feedline</span> <span class="o">=</span> <span class="n">RoutePathfinder</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;feedline&#39;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">chip</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">trace_width</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_width&quot;</span><span class="p">],</span>
                                            <span class="n">trace_gap</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_gap&quot;</span><span class="p">],</span>
                                            <span class="n">fillet</span><span class="o">=</span><span class="s1">&#39;90um&#39;</span><span class="p">,</span>
                                            <span class="n">hfss_wire_bonds</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                            <span class="n">lead</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">end_straight</span><span class="o">=</span><span class="s1">&#39;0.1mm&#39;</span><span class="p">),</span>
                                            <span class="n">pin_inputs</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
                                                <span class="n">start_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
                                                    <span class="n">component</span><span class="o">=</span><span class="s1">&#39;LP1&#39;</span><span class="p">,</span>
                                                    <span class="n">pin</span><span class="o">=</span><span class="s1">&#39;tie&#39;</span><span class="p">),</span>
                                                <span class="n">end_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
                                                    <span class="n">component</span><span class="o">=</span><span class="s1">&#39;LP2&#39;</span><span class="p">,</span>
                                                    <span class="n">pin</span><span class="o">=</span><span class="s1">&#39;tie&#39;</span><span class="p">)</span>
                                            <span class="p">)))</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#open to ground for resonator</span>
<span class="n">otg1</span> <span class="o">=</span> <span class="n">OpenToGround</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;otg1&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">chip</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">pos_x</span><span class="o">=</span><span class="s1">&#39;-0.2mm&#39;</span><span class="p">,</span>  <span class="n">pos_y</span><span class="o">=</span><span class="s1">&#39;-40um&#39;</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span> <span class="mi">180</span><span class="p">))</span>


<span class="c1"># Resonator and feedline gap width (W) and center conductor width (S)</span>
<span class="n">design</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;cpw_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_width&quot;</span><span class="p">]</span>
<span class="n">design</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;cpw_gap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_cpw</span><span class="p">[</span><span class="s2">&quot;trace_gap&quot;</span><span class="p">]</span>

<span class="c1"># Use RouteMeander to fix the total length of the resonator</span>
<span class="n">res1</span> <span class="o">=</span> <span class="n">RouteMeander</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;resonator&#39;</span><span class="p">,</span>  <span class="n">Dict</span><span class="p">(</span>
        <span class="n">trace_width</span> <span class="o">=</span><span class="s1">&#39;10um&#39;</span><span class="p">,</span>
        <span class="n">trace_gap</span> <span class="o">=</span><span class="s1">&#39;6um&#39;</span><span class="p">,</span>
        <span class="n">total_length</span><span class="o">=</span><span class="s1">&#39;3.7mm&#39;</span><span class="p">,</span>
        <span class="n">hfss_wire_bonds</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">fillet</span><span class="o">=</span><span class="s1">&#39;99.9 um&#39;</span><span class="p">,</span>
        <span class="n">lead</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">start_straight</span><span class="o">=</span><span class="s1">&#39;300um&#39;</span><span class="p">),</span>
        <span class="n">pin_inputs</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
        <span class="n">start_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span> <span class="s1">&#39;otg1&#39;</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span> <span class="s1">&#39;open&#39;</span><span class="p">),</span>
        <span class="n">end_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span> <span class="s1">&#39;claw&#39;</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)),</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<p>Check the design</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rebuild the GUI</span>
<span class="n">design</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="s1">&#39;sims/qubit-cavity.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/source_tutorials_Tutorial-7_Simulate_designs_with_palace_46_0.png" class="no-scaled-link" src="../../_images/source_tutorials_Tutorial-7_Simulate_designs_with_palace_46_0.png" style="width: 500px;" />
</div>
</div>
<p>Define the hyper-parameters for the eigenmode simulation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">SQDMetal.PALACE.Eigenmode_Simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">PALACE_Eigenmode_Simulation</span>

<span class="c1">#Eigenmode Simulation Options</span>
<span class="n">user_defined_options</span> <span class="o">=</span> <span class="p">{</span>
                 <span class="s2">&quot;mesh_refinement&quot;</span><span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>                             <span class="c1">#refines mesh in PALACE - essetially divides every mesh element in half</span>
                 <span class="s2">&quot;dielectric_material&quot;</span><span class="p">:</span> <span class="s2">&quot;silicon&quot;</span><span class="p">,</span>                  <span class="c1">#choose dielectric material - &#39;silicon&#39; or &#39;sapphire&#39;</span>
                 <span class="s2">&quot;starting_freq&quot;</span><span class="p">:</span> <span class="mf">2e9</span><span class="p">,</span>                              <span class="c1">#starting frequency in Hz</span>
                 <span class="s2">&quot;number_of_freqs&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>                              <span class="c1">#number of eigenmodes to find</span>
                 <span class="s2">&quot;solns_to_save&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>                                <span class="c1">#number of electromagnetic field visualizations to save</span>
                 <span class="s2">&quot;solver_order&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>                                 <span class="c1">#increasing solver order increases accuracy of simulation, but significantly increases sim time</span>
                 <span class="s2">&quot;solver_tol&quot;</span><span class="p">:</span> <span class="mf">1.0e-3</span><span class="p">,</span>                              <span class="c1">#error residual tolerance foriterative solver</span>
                 <span class="s2">&quot;solver_maxits&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>                              <span class="c1">#number of solver iterations</span>
                 <span class="s2">&quot;mesh_max&quot;</span><span class="p">:</span> <span class="mf">120e-3</span><span class="p">,</span>                                <span class="c1">#maxiumum element size for the mesh in mm</span>
                 <span class="s2">&quot;mesh_min&quot;</span><span class="p">:</span> <span class="mf">10e-3</span><span class="p">,</span>                                 <span class="c1">#minimum element size for the mesh in mm</span>
                 <span class="s2">&quot;mesh_sampling&quot;</span><span class="p">:</span> <span class="mi">130</span><span class="p">,</span>                              <span class="c1">#number of points to mesh along a geometry</span>
                 <span class="s2">&quot;fillet_resolution&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span>
                 <span class="s2">&quot;num_cpus&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>                                      <span class="c1">#number of CPU cores to use for simulation</span>
                 <span class="s2">&quot;palace_dir&quot;</span><span class="p">:</span><span class="n">path_to_palace</span>
                <span class="p">}</span>

<span class="c1">#Creat the Palace Eigenmode simulation</span>
<span class="n">eigen_sim</span> <span class="o">=</span> <span class="n">PALACE_Eigenmode_Simulation</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span><span class="s1">&#39;qubit-cavity-eig-test&#39;</span><span class="p">,</span>                              <span class="c1">#name of simulation</span>
                                        <span class="n">metal_design</span> <span class="o">=</span> <span class="n">design</span><span class="p">,</span>                                      <span class="c1">#feed in qiskit metal design</span>
                                        <span class="n">sim_parent_directory</span> <span class="o">=</span> <span class="s2">&quot;sims/&quot;</span><span class="p">,</span>            <span class="c1">#choose directory where mesh file, config file and HPC batch file will be saved</span>
                                        <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;simPC&#39;</span><span class="p">,</span>                                               <span class="c1">#choose simulation mode &#39;HPC&#39; or &#39;simPC&#39;</span>
                                        <span class="n">meshing</span> <span class="o">=</span> <span class="s1">&#39;GMSH&#39;</span><span class="p">,</span>                                         <span class="c1">#choose meshing &#39;GMSH&#39; or &#39;COMSOL&#39;</span>
                                        <span class="n">user_options</span> <span class="o">=</span> <span class="n">user_defined_options</span><span class="p">,</span>                        <span class="c1">#provide options chosen above</span>
                                        <span class="n">view_design_gmsh_gui</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>                               <span class="c1">#view design in GMSH gui</span>
                                        <span class="n">create_files</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>                                        <span class="c1">#create mesh, config and HPC batch files</span>
<br/></pre></div>
</div>
</div>
<p>Assigning the materials to the interfaces, add ports to the design, and add some mesh.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">SQDMetal.Utilities.Materials</span><span class="w"> </span><span class="kn">import</span> <span class="n">MaterialInterface</span>

<span class="n">eigen_sim</span><span class="o">.</span><span class="n">add_metallic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="n">fuse_threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="n">eigen_sim</span><span class="o">.</span><span class="n">add_ground_plane</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

<span class="c1">#Fine-mesh the transmon cross qubit region</span>
<span class="n">eigen_sim</span><span class="o">.</span><span class="n">fine_mesh_in_rectangle</span><span class="p">(</span><span class="mf">0.2875e-3</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2e-3</span><span class="p">,</span> <span class="mf">0.63e-3</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.72e-3</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mf">15e-6</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mf">120e-6</span><span class="p">)</span>

<span class="c1">#Add in the RF ports</span>
<span class="n">eigen_sim</span><span class="o">.</span><span class="n">create_port_CPW_on_Launcher</span><span class="p">(</span><span class="s1">&#39;LP1&#39;</span><span class="p">,</span> <span class="mf">20e-6</span><span class="p">)</span>
<span class="n">eigen_sim</span><span class="o">.</span><span class="n">create_port_CPW_on_Launcher</span><span class="p">(</span><span class="s1">&#39;LP2&#39;</span><span class="p">,</span> <span class="mf">20e-6</span><span class="p">)</span>
<span class="n">eigen_sim</span><span class="o">.</span><span class="n">create_port_JosephsonJunction</span><span class="p">(</span><span class="s1">&#39;junction&#39;</span><span class="p">,</span> <span class="n">L_J</span><span class="o">=</span><span class="n">LJs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">,</span> <span class="n">C_J</span><span class="o">=</span><span class="mf">10e-15</span><span class="p">)</span> <span class="c1"># Guessing the C_J value really</span>

<span class="c1"># #Fine-mesh routed paths</span>
<span class="n">eigen_sim</span><span class="o">.</span><span class="n">fine_mesh_around_comp_boundaries</span><span class="p">([</span><span class="s1">&#39;feedline&#39;</span><span class="p">,</span> <span class="s1">&#39;resonator&#39;</span><span class="p">],</span> <span class="n">min_size</span><span class="o">=</span><span class="mf">25e-6</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mf">250e-6</span><span class="p">)</span>
<span class="n">eigen_sim</span><span class="o">.</span><span class="n">fine_mesh_around_comp_boundaries</span><span class="p">([</span><span class="s1">&#39;xmon&#39;</span><span class="p">],</span> <span class="n">min_size</span><span class="o">=</span><span class="mf">14e-6</span><span class="p">,</span> <span class="n">max_size</span><span class="o">=</span><span class="mf">75e-6</span><span class="p">)</span>

<span class="n">eigen_sim</span><span class="o">.</span><span class="n">setup_EPR_interfaces</span><span class="p">(</span><span class="n">metal_air</span><span class="o">=</span><span class="n">MaterialInterface</span><span class="p">(</span><span class="s1">&#39;Aluminium-Vacuum&#39;</span><span class="p">),</span> <span class="n">substrate_air</span><span class="o">=</span><span class="n">MaterialInterface</span><span class="p">(</span><span class="s1">&#39;Silicon-Vacuum&#39;</span><span class="p">),</span> <span class="n">substrate_metal</span><span class="o">=</span><span class="n">MaterialInterface</span><span class="p">(</span><span class="s1">&#39;Silicon-Aluminium&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
junction_index 0
comp_id 3
gsdf   component    name                             geometry  layer  subtract  \
0         3  design  LINESTRING (0.585 -1.3, 0.615 -1.3)      2     False

   helper  chip   width hfss_inductance  hfss_capacitance  hfss_resistance  \
0   False  main  0.0054            10nH                 0                0

   hfss_mesh_kw_jj q3d_inductance  q3d_capacitance  q3d_resistance  \
0         0.000007           10nH                0               0

   q3d_mesh_kw_jj      gds_cell_name
0        0.000007  my_other_junction
gsdf   component    name                             geometry  layer  subtract  \
0         3  design  LINESTRING (0.585 -1.3, 0.615 -1.3)      2     False

   helper  chip   width hfss_inductance  hfss_capacitance  hfss_resistance  \
0   False  main  0.0054            10nH                 0                0

   hfss_mesh_kw_jj q3d_inductance  q3d_capacitance  q3d_resistance  \
0         0.000007           10nH                0               0

   q3d_mesh_kw_jj      gds_cell_name
0        0.000007  my_other_junction
ls LINESTRING (0.585 -1.3, 0.615 -1.3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigen_sim</span><span class="o">.</span><span class="n">prepare_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Directory &#39;qubit-cavity-eig-test&#39; created
</pre></div></div>
</div>
<p>Checking the meshfile</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gmsh_nav</span> <span class="o">=</span> <span class="n">GMSH_Navigator</span><span class="p">(</span><span class="n">eigen_sim</span><span class="o">.</span><span class="n">path_mesh</span><span class="p">)</span>
<span class="n">gmsh_nav</span><span class="o">.</span><span class="n">open_GUI</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>If all looks good, lets run the simulation</p>
<p><strong>NOTE:</strong> If you are using a <code class="docutils literal notranslate"><span class="pre">palace</span></code> build that is from 2025, you will need to remove the <code class="docutils literal notranslate"><span class="pre">Excitation</span></code> key from the <code class="docutils literal notranslate"><span class="pre">LumpedPort</span></code> boundary condition in the <code class="docutils literal notranslate"><span class="pre">sim_config.json</span></code> file so please execute the following cell.</p>
<p>If you are using a <code class="docutils literal notranslate"><span class="pre">palace</span></code> build that is from 2024 or older, <strong>you should skip this cell.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">eigen_sim</span><span class="o">.</span><span class="n">_sim_config</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">sim_config_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="k">del</span> <span class="n">sim_config_dict</span><span class="p">[</span><span class="s2">&quot;Boundaries&quot;</span><span class="p">][</span><span class="s2">&quot;LumpedPort&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;Excitation&quot;</span><span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">eigen_sim</span><span class="o">.</span><span class="n">_sim_config</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sim_config_dict</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigen_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt;&gt; /opt/homebrew/bin/mpirun -n 10 /Users/shanto/LFL/palace/build/bin/palace-arm64.bin qubit-cavity-eig-test.json

_____________     _______
_____   __   \____ __   /____ ____________
____   /_/  /  __ ` /  /  __ ` /  ___/  _ \
___   _____/  /_/  /  /  /_/  /  /__/  ___/
  /__/     \___,__/__/\___,__/\_____\_____/

Git changeset ID: v0.13.0-117-g748660c
Running with 10 MPI processes
Device configuration: cpu
Memory configuration: host-std
libCEED backend: /cpu/self/xsmm/blocked

Added 2574 elements in 2 iterations of local bisection for under-resolved interior boundaries
Added 5333 duplicate vertices for interior boundaries in the mesh
Added 12701 duplicate boundary elements for interior boundaries in the mesh
Added 1550 boundary elements for material interfaces to the mesh
Finished partitioning mesh into 10 subdomains

Characteristic length and time scales:
 L₀ = 5.520e-03 m, t₀ = 1.841e-02 ns

Mesh curvature order: 1
Mesh bounding box:
 (Xmin, Ymin, Zmin) = (-2.760e-03, -2.440e-03, -2.800e-04) m
 (Xmax, Ymax, Zmax) = (+2.760e-03, +4.400e-04, +2.800e-04) m

Parallel Mesh Stats:

                minimum     average     maximum       total
 vertices          2786        3522        3859       35223
 edges            18749       20919       22124      209195
 faces            31110       32653       33699      326538
 elements         15011       15256       15457      152568
 neighbors            2           4           5

            minimum     maximum
 h      0.000513927   0.0271869
 kappa      1.01967     157.435

Configuring Robin absorbing BC (order 1) at attributes:
 13

Configuring Robin impedance BC for lumped ports at attributes:
 5: Rs = 6.667e+01 Ω/sq, n = (+0.0, +0.0, +1.0)
 6: Rs = 6.667e+01 Ω/sq, n = (+0.0, +0.0, -1.0)
 7: Rs = 6.667e+01 Ω/sq, n = (-0.0, +0.0, +1.0)
 8: Rs = 6.667e+01 Ω/sq, n = (+0.0, +0.0, -1.0)
 9: Ls = 5.725e-09 H/sq, Cs = 2.778e-14 F/sq, n = (+0.0, +0.0, +1.0)

Configuring lumped port circuit properties:
 Index = 1: R = 5.000e+01 Ω
 Index = 2: R = 5.000e+01 Ω
 Index = 3: L = 1.590e-08 H, C = 1.000e-14 F

Configuring lumped port excitation source term at attributes:
 5: Index = 1
 6: Index = 1

Configuring Dirichlet PEC BC at attributes:
 1-4

Assembling system matrices, number of global unknowns:
 H1 (p = 1): 35223, ND (p = 1): 209195, RT (p = 1): 326538
 Operator assembly level: Partial
 Mesh geometries:
  Tetrahedron: P = 6, Q = 4 (quadrature order = 2)

Configuring SLEPc eigenvalue solver:
 Scaling γ = 4.711e+02, δ = 1.089e-05
 Configuring divergence-free projection
 Using random starting vector
 Shift-and-invert σ = 2.000e+00 GHz (2.314e-01)

Assembling multigrid hierarchy:
 Level 0 (p = 1): 209195 unknowns, 3111237 NNZ
 Level 0 (auxiliary) (p = 1): 35223 unknowns, 467972 NNZ

#PETSc Option Table entries:
-eps_monitor # (source: code)
#End of PETSc Option Table entries

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 1.430279e+03
1 (restart 0) KSP residual norm 1.025289e-01
FGMRES solver converged in 1 iteration (avg. reduction factor: 7.168e-05)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 3.363427e+02
1 (restart 0) KSP residual norm 4.284830e-01
2 (restart 0) KSP residual norm 5.323492e-02
FGMRES solver converged in 2 iterations (avg. reduction factor: 1.258e-02)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 4.995177e+01
1 (restart 0) KSP residual norm 2.962309e-01
2 (restart 0) KSP residual norm 1.384106e-01
3 (restart 0) KSP residual norm 4.256018e-03
FGMRES solver converged in 3 iterations (avg. reduction factor: 4.400e-02)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.399569e+02
1 (restart 0) KSP residual norm 1.230768e+00
2 (restart 0) KSP residual norm 5.933160e-01
3 (restart 0) KSP residual norm 2.217576e-02
FGMRES solver converged in 3 iterations (avg. reduction factor: 4.521e-02)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 1.244339e+02
1 (restart 0) KSP residual norm 1.137913e+00
2 (restart 0) KSP residual norm 3.299754e-01
3 (restart 0) KSP residual norm 1.271091e-02
FGMRES solver converged in 3 iterations (avg. reduction factor: 4.675e-02)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.330694e+02
1 (restart 0) KSP residual norm 6.423500e+00
2 (restart 0) KSP residual norm 2.903788e+00
3 (restart 0) KSP residual norm 5.072627e-02
FGMRES solver converged in 3 iterations (avg. reduction factor: 6.015e-02)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 1.177260e+02
1 (restart 0) KSP residual norm 1.965855e+01
2 (restart 0) KSP residual norm 1.019226e+01
3 (restart 0) KSP residual norm 4.281215e-02
FGMRES solver converged in 3 iterations (avg. reduction factor: 7.138e-02)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 7.166516e+01
1 (restart 0) KSP residual norm 1.882151e+01
2 (restart 0) KSP residual norm 8.034346e+00
3 (restart 1) KSP residual norm 8.581616e-02
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.062e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.197e-03 (norm(b) = 7.167e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 4.438828e+01
1 (restart 0) KSP residual norm 3.915629e+01
2 (restart 0) KSP residual norm 2.771825e+01
3 (restart 1) KSP residual norm 1.376060e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.458e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 3.100e-03 (norm(b) = 4.439e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 1.881353e+01
1 (restart 0) KSP residual norm 1.794439e+01
2 (restart 0) KSP residual norm 1.621458e+01
3 (restart 1) KSP residual norm 2.216238e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.275e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.178e-02 (norm(b) = 1.881e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 7.437849e+01
1 (restart 0) KSP residual norm 4.763870e+01
2 (restart 0) KSP residual norm 2.423142e+01
3 (restart 1) KSP residual norm 1.437091e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.246e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.932e-03 (norm(b) = 7.438e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 3.741477e+01
1 (restart 0) KSP residual norm 1.922261e+01
2 (restart 0) KSP residual norm 1.103699e+01
3 (restart 1) KSP residual norm 1.051296e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.411e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 2.810e-03 (norm(b) = 3.741e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 5.816988e+01
1 (restart 0) KSP residual norm 1.515933e+01
2 (restart 0) KSP residual norm 4.254471e+00
3 (restart 1) KSP residual norm 1.630771e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.410e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 2.803e-03 (norm(b) = 5.817e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 9.802765e+01
1 (restart 0) KSP residual norm 1.492573e+01
2 (restart 0) KSP residual norm 3.576845e+00
3 (restart 1) KSP residual norm 2.360518e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.340e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 2.408e-03 (norm(b) = 9.803e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 7.515375e+01
1 (restart 0) KSP residual norm 2.017880e+01
2 (restart 0) KSP residual norm 1.033416e+01
3 (restart 1) KSP residual norm 2.479146e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.489e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 3.299e-03 (norm(b) = 7.515e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.893357e+01
1 (restart 0) KSP residual norm 1.684602e+01
2 (restart 0) KSP residual norm 6.739751e+00
3 (restart 1) KSP residual norm 3.242988e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.238e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.121e-02 (norm(b) = 2.893e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 6.275295e+01
1 (restart 0) KSP residual norm 3.481008e+01
2 (restart 0) KSP residual norm 8.956124e+00
3 (restart 1) KSP residual norm 2.241883e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.529e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 3.573e-03 (norm(b) = 6.275e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 9.813472e+01
1 (restart 0) KSP residual norm 5.771669e+01
2 (restart 0) KSP residual norm 2.303100e+01
3 (restart 1) KSP residual norm 3.287282e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.496e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 3.350e-03 (norm(b) = 9.813e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 7.720087e+01
1 (restart 0) KSP residual norm 6.971518e+01
2 (restart 0) KSP residual norm 5.686820e+01
3 (restart 1) KSP residual norm 6.714616e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.057e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 8.698e-03 (norm(b) = 7.720e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 7.639017e+01
1 (restart 0) KSP residual norm 5.367808e+01
2 (restart 0) KSP residual norm 3.439339e+01
3 (restart 1) KSP residual norm 4.234665e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.770e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 5.543e-03 (norm(b) = 7.639e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 4.046560e+01
1 (restart 0) KSP residual norm 3.724985e+01
2 (restart 0) KSP residual norm 2.932031e+01
3 (restart 1) KSP residual norm 5.039644e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.318e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.245e-02 (norm(b) = 4.047e+01)!

  Eigenvalue approximations and residual norms for  solve.
  1 EPS nconv=3 first unconverged value (error) -5.998e-05+0.00236959i (7.88449141e-03)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 9.338349e+01
1 (restart 0) KSP residual norm 6.841510e+01
2 (restart 0) KSP residual norm 1.550947e+01
3 (restart 1) KSP residual norm 3.357865e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.532e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 3.596e-03 (norm(b) = 9.338e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 3.848784e+01
1 (restart 0) KSP residual norm 3.529328e+01
2 (restart 0) KSP residual norm 1.276480e+01
3 (restart 1) KSP residual norm 4.107502e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.202e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.067e-02 (norm(b) = 3.849e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.146029e+01
1 (restart 0) KSP residual norm 1.793997e+01
2 (restart 0) KSP residual norm 3.548141e+00
3 (restart 1) KSP residual norm 3.490974e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.534e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.627e-02 (norm(b) = 2.146e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.626260e+01
1 (restart 0) KSP residual norm 1.619918e+01
2 (restart 0) KSP residual norm 9.739603e+00
3 (restart 1) KSP residual norm 2.572753e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.140e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 9.796e-03 (norm(b) = 2.626e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 6.053147e+01
1 (restart 0) KSP residual norm 3.773026e+01
2 (restart 0) KSP residual norm 9.382156e+00
3 (restart 1) KSP residual norm 3.134885e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.730e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 5.179e-03 (norm(b) = 6.053e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 3.068717e+01
1 (restart 0) KSP residual norm 2.227398e+01
2 (restart 0) KSP residual norm 1.148234e+01
3 (restart 1) KSP residual norm 3.263638e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.199e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.064e-02 (norm(b) = 3.069e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 3.999937e+01
1 (restart 0) KSP residual norm 3.774822e+01
2 (restart 0) KSP residual norm 3.236761e+01
3 (restart 1) KSP residual norm 4.540011e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.247e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.135e-02 (norm(b) = 4.000e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 5.487623e+01
1 (restart 0) KSP residual norm 1.479387e+01
2 (restart 0) KSP residual norm 3.903353e+00
3 (restart 1) KSP residual norm 3.849087e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.914e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 7.014e-03 (norm(b) = 5.488e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.998246e+01
1 (restart 0) KSP residual norm 2.593478e+01
2 (restart 0) KSP residual norm 1.755311e+01
3 (restart 1) KSP residual norm 2.091028e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.911e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 6.974e-03 (norm(b) = 2.998e+01)!

  2 EPS nconv=3 first unconverged value (error) -6.48948e-06+0.00237218i (3.24935860e-03)
Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 9.155592e+01
1 (restart 0) KSP residual norm 7.560707e+01
2 (restart 0) KSP residual norm 5.350624e+01
3 (restart 1) KSP residual norm 3.359198e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.542e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 3.669e-03 (norm(b) = 9.156e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 4.328256e+01
1 (restart 0) KSP residual norm 5.176989e+00
2 (restart 0) KSP residual norm 2.643317e+00
3 (restart 1) KSP residual norm 7.311574e-02
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.191e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 1.689e-03 (norm(b) = 4.328e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.654266e+01
1 (restart 0) KSP residual norm 2.470910e+01
2 (restart 0) KSP residual norm 1.929179e+01
3 (restart 1) KSP residual norm 1.585695e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.815e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 5.974e-03 (norm(b) = 2.654e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.883869e+01
1 (restart 0) KSP residual norm 2.513034e+01
2 (restart 0) KSP residual norm 1.667713e+01
3 (restart 1) KSP residual norm 1.766817e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.830e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 6.127e-03 (norm(b) = 2.884e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.437329e+01
1 (restart 0) KSP residual norm 2.136595e+01
2 (restart 0) KSP residual norm 1.101337e+01
3 (restart 1) KSP residual norm 1.470360e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.820e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 6.033e-03 (norm(b) = 2.437e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 2.322880e+01
1 (restart 0) KSP residual norm 1.508158e+01
2 (restart 0) KSP residual norm 2.701044e+00
3 (restart 1) KSP residual norm 1.939752e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.029e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 8.351e-03 (norm(b) = 2.323e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 1.839043e+01
1 (restart 0) KSP residual norm 1.748318e+01
2 (restart 0) KSP residual norm 1.323021e+01
3 (restart 1) KSP residual norm 1.401872e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.968e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 7.623e-03 (norm(b) = 1.839e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 3.768538e+01
1 (restart 0) KSP residual norm 2.925403e+01
2 (restart 0) KSP residual norm 1.883911e+01
3 (restart 1) KSP residual norm 3.743735e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 2.150e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 9.934e-03 (norm(b) = 3.769e+01)!

Residual norms for FGMRES solve
0 (restart 0) KSP residual norm 6.221830e+01
1 (restart 0) KSP residual norm 2.570890e+01
2 (restart 0) KSP residual norm 1.159048e+01
3 (restart 1) KSP residual norm 3.742700e-01
FGMRES solver did NOT converge in 3 iterations (avg. reduction factor: 1.819e-01)

<span style="color: rgb(255,255,0)">--&gt; Warning!</span>
Linear solver did not converge, norm(Ax-b)/norm(b) = 6.015e-03 (norm(b) = 6.222e+01)!

  3 EPS nconv=6 first unconverged value (error) -5.03847e-05+0.00284044i (5.04191480e-03)

 Linear eigensolve converged (6 eigenpairs) due to CONVERGED_TOL; iterations 3
 Total number of linear systems solved: 39
 Total number of linear solver iterations: 114
 Found 6 converged eigenvalues (first = -1.642e-05+3.629e-01i)

Computing solution error estimates and performing postprocessing

m     Re{ω}/2π (GHz)     Im{ω}/2π (GHz)        Bkwd. Error         Abs. Error
=============================================================================
1      +3.136773e+00      +1.419088e-04      +7.453931e-09      +1.332296e-03
 Wrote mode 1 to disk
2      +7.182393e+00      +5.380578e-02      +1.006761e-06      +1.799512e-01
 Wrote mode 2 to disk
3      +7.984743e+00      +6.055970e-02      +1.045469e-06      +1.868712e-01
 Wrote mode 3 to disk
4      +9.637757e+00      +4.853337e-02      +1.024503e-06      +1.831260e-01
 Wrote mode 4 to disk
5      +9.940094e+00      +7.946014e-02      +1.765757e-06      +3.156229e-01
 Wrote mode 5 to disk
6      +1.069663e+01      +2.472291e-01      +8.803651e-07      +1.573632e-01
 Wrote mode 6 to disk

Completed 0 iterations of adaptive mesh refinement (AMR):
 Indicator norm = 4.003e-01, global unknowns = 209195
 Max. iterations = 0, tol. = 1.000e-02

Elapsed Time Report (s)           Min.        Max.        Avg.
==============================================================
Initialization                   3.184       3.198       3.191
Operator Construction            2.665       2.676       2.671
Linear Solve                     5.557       5.659       5.614
  Setup                          0.108       0.110       0.109
  Preconditioner                16.511      16.565      16.534
Eigenvalue Solve                 3.027       3.133       3.096
Div.-Free Projection            12.666      12.764      12.724
Estimation                       0.139       0.187       0.158
  Construction                   3.149       3.152       3.151
  Solve                         14.262      14.295      14.281
Postprocessing                   1.471       1.508       1.484
Disk IO                          8.765       8.772       8.768
--------------------------------------------------------------
Total                           71.902      71.911      71.906

Error in plotting: &#39;Data array (E_real) not present in this dataset.&#39;
</pre></div></div>
</div>
<p>Reading the eigenmode data now</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">read_csv_to_dataframe</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="n">eigen_df</span> <span class="o">=</span> <span class="n">read_csv_to_dataframe</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">eigen_sim</span><span class="o">.</span><span class="n">_output_data_dir</span><span class="p">,</span> <span class="s1">&#39;eig.csv&#39;</span><span class="p">))</span>
<span class="n">eigen_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">eigen_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">eigen_df</span><span class="p">[</span><span class="s2">&quot;kappa (kHz)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigen_df</span><span class="p">[</span><span class="s2">&quot;Re</span><span class="si">{f}</span><span class="s2"> (GHz)&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">eigen_df</span><span class="p">[</span><span class="s2">&quot;Q&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span>
<span class="n">eigen_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>m</th>
      <th>Re{f} (GHz)</th>
      <th>Im{f} (GHz)</th>
      <th>Q</th>
      <th>Error (Bkwd.)</th>
      <th>Error (Abs.)</th>
      <th>kappa (kHz)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>3.136773</td>
      <td>0.000142</td>
      <td>11052.078980</td>
      <td>7.453931e-09</td>
      <td>0.001332</td>
      <td>283.817505</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>7.182393</td>
      <td>0.053806</td>
      <td>66.745561</td>
      <td>1.006761e-06</td>
      <td>0.179951</td>
      <td>107608.543661</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>7.984743</td>
      <td>0.060560</td>
      <td>65.926448</td>
      <td>1.045469e-06</td>
      <td>0.186871</td>
      <td>121115.923577</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.0</td>
      <td>9.637757</td>
      <td>0.048533</td>
      <td>99.291263</td>
      <td>1.024503e-06</td>
      <td>0.183126</td>
      <td>97065.505810</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>9.940094</td>
      <td>0.079460</td>
      <td>62.549670</td>
      <td>1.765757e-06</td>
      <td>0.315623</td>
      <td>158915.201768</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.0</td>
      <td>10.696626</td>
      <td>0.247229</td>
      <td>21.638798</td>
      <td>8.803651e-07</td>
      <td>0.157363</td>
      <td>494326.244903</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>From our requirements, we wanted a qubit frequency of 3.7 GHz and a cavity frequency of</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_params</span><span class="p">[</span><span class="s2">&quot;cavity_frequency_GHz&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
6.98
</pre></div></div>
</div>
<p>From the simulations, it seems like mode 1 is the qubit mode (found to be 3.136 GHz) and mode 2 is the cavity mode (found to be 7.183 GHz) given their frequencies</p>
<p>Lets’ visualize all the eigenmodes in <code class="docutils literal notranslate"><span class="pre">paraview</span></code> to see if thats the case. Here are some screenshots from this toy example.</p>
<table><tr><td><p><img alt="Mode 2" class="no-scaled-link" src="../../_images/qubit-mode1.png" style="width: 50%;" /></p>
</td><td><p><img alt="Mode 4" class="no-scaled-link" src="../../_images/cavity-mode2.png" style="width: 50%;" /></p>
</td><td><p><img alt="Mode 4" class="no-scaled-link" src="../../_images/cavity-mode3.png" style="width: 50%;" /></p>
</td></tr><tr><td><p>Mode 1: Qubit Mode</p>
</td><td><p>Mode 2: Cavity Mode?</p>
</td><td><p>Mode 3: Cavity Mode?</p>
</td></tr></table><p>It seems like that indeed mode 1 is the qubit mode and mode 3 looks to be like the cavity mode (apologies for the bad quality of the images).</p>
<p><strong>Of course, this simulation was done with really coarse hyperparameters (ran in 1.5 minutes on my 2021 Macbook Pro) so this results are somewhat promising!</strong></p>
</section>
</section>
</section>
<section id="EPR-Calculations">
<h2>EPR Calculations<a class="headerlink" href="#EPR-Calculations" title="Link to this heading">#</a></h2>
<p>Since <code class="docutils literal notranslate"><span class="pre">palace</span></code> does automatic postprocessing of energy-participation ratios (EPRs) for circuit quantization and interface or bulk participation ratios for predicting dielectric loss, we can use this to do some quantum analysis from the eigenmode simulation when lumped inductive elements (i.e. josephson junctions) exist in the simulated geometry.</p>
<p>First, we need to retrieve the mode-port EPRs from the eigenmode simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mode_dict</span> <span class="o">=</span> <span class="n">eigen_sim</span><span class="o">.</span><span class="n">retrieve_mode_port_EPR_from_file</span><span class="p">(</span><span class="n">eigen_sim</span><span class="o">.</span><span class="n">_output_data_dir</span><span class="p">)</span>

<span class="c1">#get particpation ratios and frequencies from the simulation</span>
<span class="n">participation_ratios</span> <span class="o">=</span> <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;mat_mode_port&#39;</span><span class="p">]</span>
<span class="n">frequencies</span> <span class="o">=</span> <span class="n">mode_dict</span><span class="p">[</span><span class="s1">&#39;eigenfrequencies&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>We have identified the qubit and cavity modes from the eigenmode simulation as mode 3 and mode 4 respectively.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qubit_idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">cavity_idx</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linear_qubit_freq</span> <span class="o">=</span> <span class="n">eigen_df</span><span class="p">[</span><span class="s1">&#39;Re</span><span class="si">{f}</span><span class="s1"> (GHz)&#39;</span><span class="p">][</span><span class="n">qubit_idx</span><span class="p">]</span><span class="o">*</span><span class="mf">1e9</span>
<span class="n">linear_res_freq</span> <span class="o">=</span> <span class="n">eigen_df</span><span class="p">[</span><span class="s1">&#39;Re</span><span class="si">{f}</span><span class="s1"> (GHz)&#39;</span><span class="p">][</span><span class="n">cavity_idx</span><span class="p">]</span><span class="o">*</span><span class="mf">1e9</span>
<span class="n">P_qubit</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">participation_ratios</span><span class="p">[</span><span class="n">qubit_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">P_cav</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">participation_ratios</span><span class="p">[</span><span class="n">cavity_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P_qubit</span><span class="p">,</span> <span class="n">P_cav</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.9902988796, 5.020978473e-05)
</pre></div></div>
</div>
<p>Now, let’s calculate the qubit and cavity Hamiltonian parameters using these participation ratios.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Constants used for calculations</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">Planck</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">hbar</span>
<span class="n">phi0</span> <span class="o">=</span> <span class="n">hbar</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">)</span>

<span class="c1">#Josephson Energy (Ej) and linear inductance (Lj)</span>
<span class="n">delta_super</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.8e-4</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span>
<span class="n">Lj</span> <span class="o">=</span> <span class="n">LJs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-9</span>
<span class="n">Ej</span> <span class="o">=</span> <span class="n">phi0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">Lj</span>

<span class="c1">#Normalize Participation Ratios</span>
<span class="n">P_qubit_normalised</span> <span class="o">=</span> <span class="n">P_qubit</span> <span class="o">/</span> <span class="p">(</span><span class="n">P_qubit</span> <span class="o">+</span> <span class="n">P_cav</span><span class="p">)</span>
<span class="n">P_cav_normalised</span> <span class="o">=</span> <span class="n">P_cav</span> <span class="o">/</span> <span class="p">(</span><span class="n">P_qubit</span> <span class="o">+</span> <span class="n">P_cav</span><span class="p">)</span>

<span class="c1">#Enter in Frequencies from Simulation</span>
<span class="n">omega_qubit</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">linear_qubit_freq</span>
<span class="n">omega_res</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">linear_res_freq</span>

<span class="c1">#phi zero-point fluctuations for qubit</span>
<span class="n">phi_zpf_sq</span> <span class="o">=</span> <span class="n">P_qubit</span> <span class="o">*</span> <span class="n">hbar</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">omega_qubit</span>  <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Ej</span><span class="p">)</span>

<span class="c1">#anharmonicity qubit (self kerr)</span>
<span class="n">anharm_qubit</span> <span class="o">=</span> <span class="n">P_qubit</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega_qubit</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">Ej</span><span class="p">)</span>

<span class="c1">#anharmonicity resonator (self kerr)</span>
<span class="n">anharm_res</span> <span class="o">=</span> <span class="n">P_cav</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega_res</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">Ej</span><span class="p">)</span>

<span class="c1">#Charging Energy (Ec)</span>
<span class="n">Ec</span> <span class="o">=</span> <span class="n">anharm_qubit</span> <span class="o">*</span> <span class="n">hbar</span>

<span class="c1">#Total Capacitance</span>
<span class="n">C_total</span> <span class="o">=</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Ec</span><span class="p">)</span>

<span class="c1">#cross kerr - dispersive shit (chi)</span>
<span class="n">cross_kerr</span> <span class="o">=</span> <span class="p">(</span><span class="n">P_qubit</span> <span class="o">*</span> <span class="n">P_cav</span> <span class="o">*</span> <span class="n">hbar</span> <span class="o">*</span> <span class="n">omega_qubit</span> <span class="o">*</span> <span class="n">omega_res</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Ej</span><span class="p">)</span>

<span class="c1">#lamb-shift of qubit frequency</span>
<span class="n">lamb_shift_qubit</span> <span class="o">=</span> <span class="n">anharm_qubit</span> <span class="o">-</span> <span class="n">cross_kerr</span><span class="o">/</span><span class="mi">2</span>

<span class="c1">#lamb-shift of res frequency</span>
<span class="n">lamb_shift_res</span> <span class="o">=</span> <span class="n">anharm_res</span> <span class="o">-</span> <span class="n">cross_kerr</span><span class="o">/</span><span class="mi">2</span>

<span class="c1">#detuning, delta</span>
<span class="n">delta</span> <span class="o">=</span> <span class="p">((</span><span class="n">linear_res_freq</span> <span class="o">-</span> <span class="n">anharm_res</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">linear_qubit_freq</span> <span class="o">-</span> <span class="n">anharm_qubit</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span>

<span class="c1">#resonator-qubit coupling strength (g)</span>
<span class="n">disp_shift_qubit</span> <span class="o">=</span> <span class="n">cross_kerr</span>
<span class="n">g_rwa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">disp_shift_qubit</span> <span class="o">*</span> <span class="n">delta</span>  <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">delta</span><span class="o">/</span><span class="n">anharm_qubit</span><span class="p">))</span>

<span class="c1"># coupling strength (g) from SQuADDS Paper</span>
<span class="n">Delta</span> <span class="o">=</span> <span class="n">omega_res</span> <span class="o">-</span> <span class="n">omega_qubit</span>      <span class="c1"># rad/s</span>
<span class="n">Sigma</span> <span class="o">=</span> <span class="n">omega_res</span> <span class="o">+</span> <span class="n">omega_qubit</span>      <span class="c1"># rad/s</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span><span class="n">anharm_qubit</span>                <span class="c1"># rad/s (already angular)</span>
<span class="n">chi</span> <span class="o">=</span> <span class="o">-</span><span class="n">disp_shift_qubit</span>              <span class="c1"># rad/s (already angular)</span>
<span class="c1"># Denominator (s/rad)</span>
<span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="n">Delta</span> <span class="o">*</span> <span class="p">(</span><span class="n">Delta</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)))</span> <span class="o">-</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="n">Sigma</span> <span class="o">*</span> <span class="p">(</span><span class="n">Sigma</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)))</span>

<span class="c1"># Convert to linear frequency in MHz (optional, for reporting)</span>
<span class="n">g_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">chi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">denom</span><span class="p">))</span>     <span class="c1"># rad/s</span>
<span class="n">g_MHz</span> <span class="o">=</span> <span class="n">g_rad</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>    <span class="c1"># MHz</span>
</pre></div>
</div>
</div>
<p>Interesting to check what <code class="docutils literal notranslate"><span class="pre">scqubits</span></code> says about the Hamiltonian parameters computed using the simulation results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scqubits</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">scq</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scqubits.core.transmon</span><span class="w"> </span><span class="kn">import</span> <span class="n">Transmon</span>

<span class="n">scq</span><span class="o">.</span><span class="n">set_units</span><span class="p">(</span><span class="s2">&quot;GHz&quot;</span><span class="p">)</span>

<span class="c1"># Using scqubits to find the Josephson energy and charging energy using the qubit frequency and anharmonicity from EPR</span>
<span class="n">qubit_freq_GHz</span> <span class="o">=</span> <span class="n">linear_qubit_freq</span><span class="o">/</span><span class="mf">1e9</span> <span class="o">-</span> <span class="n">lamb_shift_qubit</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e9</span><span class="p">)</span>
<span class="n">qubit_anharm_GHz</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">EJ_scq</span><span class="p">,</span> <span class="n">EC_scq</span> <span class="o">=</span> <span class="n">Transmon</span><span class="o">.</span><span class="n">find_EJ_EC</span><span class="p">(</span><span class="n">qubit_freq_GHz</span><span class="p">,</span> <span class="n">qubit_anharm_GHz</span><span class="p">)</span>


<span class="c1"># Using scqubits to find the qubit frequency and anharmonicity now using the Josephson energy and charging energy from EP</span>
<span class="n">EJ_GHz</span> <span class="o">=</span> <span class="n">Ej</span> <span class="o">/</span> <span class="p">(</span><span class="n">hbar</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span>  <span class="mf">1e9</span><span class="p">)</span>
<span class="n">EC_GHz</span> <span class="o">=</span> <span class="n">anharm_qubit</span>  <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e9</span><span class="p">)</span>
<span class="n">transmon</span> <span class="o">=</span> <span class="n">Transmon</span><span class="p">(</span><span class="n">EJ</span><span class="o">=</span><span class="n">EJ_GHz</span><span class="p">,</span> <span class="n">EC</span><span class="o">=</span><span class="n">EC_GHz</span><span class="p">,</span> <span class="n">ng</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ncut</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">qubit_freq_scq</span><span class="o">=</span> <span class="n">transmon</span><span class="o">.</span><span class="n">E01</span><span class="p">()</span>
<span class="n">anharm_qubit_scq</span> <span class="o">=</span> <span class="n">transmon</span><span class="o">.</span><span class="n">anharmonicity</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1E3</span>  <span class="c1"># MHz</span>

<span class="c1"># Using scqubits to find the C_qubit capacitance</span>

<span class="k">def</span><span class="w"> </span><span class="nf">C_qubit_from_Ec</span><span class="p">(</span><span class="n">Ec</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the capacitance (C_qubit) in fF from the charging energy (Ec) in GHz.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Ec_Joules</span> <span class="o">=</span> <span class="n">Ec</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="n">Planck</span>
    <span class="n">Cs_SI</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Ec_Joules</span><span class="p">)</span>
    <span class="n">Cs_fF</span> <span class="o">=</span> <span class="n">Cs_SI</span> <span class="o">*</span> <span class="mf">1e15</span>
    <span class="k">return</span> <span class="n">Cs_fF</span>

<span class="n">C_qubit_scq</span> <span class="o">=</span> <span class="n">C_qubit_from_Ec</span><span class="p">(</span><span class="n">EC_scq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:py.warnings:UserWarning: Changing units (by calling set_units()) after initializing qubit instances is likely to cause unintended inconsistencies.
 /opt/homebrew/Caskroom/mambaforge/base/envs/squadds_staging_env/lib/python3.10/site-packages/scqubits/core/units.py: 65
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hamiltonian_params</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Ej&quot;</span><span class="p">,</span> <span class="n">Ej</span> <span class="o">/</span> <span class="p">(</span><span class="n">hbar</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span>  <span class="mf">1e9</span><span class="p">),</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Ej (scqubits)&quot;</span><span class="p">,</span> <span class="n">EJ_scq</span><span class="p">,</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Ec&quot;</span><span class="p">,</span> <span class="n">anharm_qubit</span>  <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e9</span><span class="p">),</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Ec (scqubits)&quot;</span><span class="p">,</span> <span class="n">EC_scq</span><span class="p">,</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Ej/Ec&quot;</span><span class="p">,</span> <span class="n">Ej</span><span class="o">/</span><span class="n">Ec</span><span class="p">,</span> <span class="s2">&quot;unitless&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Ej/Ec (scqubits)&quot;</span><span class="p">,</span> <span class="n">EJ_scq</span><span class="o">/</span><span class="n">EC_scq</span><span class="p">,</span> <span class="s2">&quot;unitless&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Lj&quot;</span><span class="p">,</span> <span class="n">Lj</span><span class="o">/</span><span class="mf">1e-9</span><span class="p">,</span> <span class="s2">&quot;nH&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;C_qubit&quot;</span><span class="p">,</span> <span class="n">C_total</span><span class="o">/</span><span class="mf">1e-15</span><span class="p">,</span> <span class="s2">&quot;fF&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;C_qubit (scqubits)&quot;</span><span class="p">,</span> <span class="n">C_qubit_scq</span><span class="p">,</span> <span class="s2">&quot;fF&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;C_qubit (from SQuADDS DB)&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;cross_to_claw&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;cross_to_ground&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;fF&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Participation Ratio Qubit&quot;</span><span class="p">,</span> <span class="n">P_qubit</span><span class="p">,</span> <span class="s2">&quot;unitless&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Participation Ratio Qubit (Normalized)&quot;</span><span class="p">,</span> <span class="n">P_qubit_normalised</span><span class="p">,</span> <span class="s2">&quot;unitless&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Participation Ratio Cavity&quot;</span><span class="p">,</span> <span class="n">P_cav</span><span class="p">,</span> <span class="s2">&quot;unitless&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Participation Ratio Cavity (Normalized)&quot;</span><span class="p">,</span> <span class="n">P_cav_normalised</span><span class="p">,</span> <span class="s2">&quot;unitless&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Linear Qubit Frequency&quot;</span><span class="p">,</span> <span class="n">linear_qubit_freq</span><span class="o">/</span><span class="mf">1e9</span><span class="p">,</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Qubit Frequency&quot;</span><span class="p">,</span> <span class="n">linear_qubit_freq</span><span class="o">/</span><span class="mf">1e9</span> <span class="o">-</span> <span class="n">lamb_shift_qubit</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e9</span><span class="p">),</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Qubit Frequency (scqubits)&quot;</span><span class="p">,</span> <span class="n">qubit_freq_scq</span><span class="p">,</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Qubit Frequency (from SQuADDS DB)&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;qubit_frequency_GHz&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Qubit Anharmonicity&quot;</span><span class="p">,</span> <span class="n">anharm_qubit</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">),</span> <span class="s2">&quot;MHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Qubit Anharmonicity (scqubits)&quot;</span><span class="p">,</span> <span class="o">-</span><span class="n">anharm_qubit_scq</span><span class="p">,</span> <span class="s2">&quot;MHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Qubit Anharmonicity (from SQuADDS DB)&quot;</span><span class="p">,</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;anharmonicity_MHz&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;MHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Linear Cavity Frequency&quot;</span><span class="p">,</span> <span class="n">linear_res_freq</span><span class="o">/</span><span class="mf">1e9</span><span class="p">,</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Cavity Frequency&quot;</span><span class="p">,</span> <span class="n">linear_res_freq</span><span class="o">/</span><span class="mf">1e9</span> <span class="o">-</span> <span class="n">lamb_shift_res</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e9</span><span class="p">),</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Cavity Anharmonicity&quot;</span><span class="p">,</span> <span class="n">anharm_res</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">),</span> <span class="s2">&quot;MHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Dispersive Shift (chi)&quot;</span><span class="p">,</span> <span class="n">cross_kerr</span><span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">),</span> <span class="s2">&quot;MHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Cavity-Qubit Coupling [Ref. SQuADDS], g&quot;</span><span class="p">,</span> <span class="n">g_MHz</span><span class="p">,</span> <span class="s2">&quot;MHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Cavity-Qubit Coupling [RWA], g&quot;</span><span class="p">,</span> <span class="n">g_rwa</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e6</span><span class="p">),</span> <span class="s2">&quot;MHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Detuning&quot;</span><span class="p">,</span> <span class="n">delta</span><span class="o">/</span><span class="mf">1e9</span><span class="p">,</span> <span class="s2">&quot;GHz&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Flux_ZPF_squared&quot;</span><span class="p">,</span> <span class="n">phi_zpf_sq</span><span class="p">,</span> <span class="s2">&quot;unitless&quot;</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Create DataFrame</span>
<span class="n">hamiltonian_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">hamiltonian_params</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Parameter&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">,</span> <span class="s2">&quot;Unit&quot;</span><span class="p">])</span>

<span class="c1"># Function to format values</span>
<span class="k">def</span><span class="w"> </span><span class="nf">format_float_six_decimal</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Apply formatting</span>
<span class="n">hamiltonian_df</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">format_float_six_decimal</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hamiltonian_df</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">])</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">hamiltonian_df</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                              Parameter      Value     Unit
                                     Ej  10.278024      GHz
                          Ej (scqubits)  11.403408      GHz
                                     Ec   0.117354      GHz
                          Ec (scqubits)   0.107456      GHz
                                  Ej/Ec  87.581095 unitless
                       Ej/Ec (scqubits) 106.121806 unitless
                                     Lj  15.903982       nH
                                C_qubit 165.057588       fF
                     C_qubit (scqubits) 180.262233       fF
              C_qubit (from SQuADDS DB) 107.321280       fF
              Participation Ratio Qubit   0.990299 unitless
 Participation Ratio Qubit (Normalized)   0.999949 unitless
             Participation Ratio Cavity   0.000050 unitless
Participation Ratio Cavity (Normalized)   0.000051 unitless
                 Linear Qubit Frequency   3.136773      GHz
                        Qubit Frequency   3.019434      GHz
             Qubit Frequency (scqubits)   2.984043      GHz
      Qubit Frequency (from SQuADDS DB)   3.662130      GHz
                    Qubit Anharmonicity 117.354370      MHz
         Qubit Anharmonicity (scqubits) 129.507341      MHz
  Qubit Anharmonicity (from SQuADDS DB) 205.109839      MHz
                Linear Cavity Frequency   7.984743      GHz
                       Cavity Frequency   7.984758      GHz
                   Cavity Anharmonicity   0.000002      MHz
                 Dispersive Shift (chi)   0.030292      MHz
Cavity-Qubit Coupling [Ref. SQuADDS], g  62.188858      MHz
         Cavity-Qubit Coupling [RWA], g  13.606564      MHz
                               Detuning   4.965324      GHz
                       Flux_ZPF_squared   0.302232 unitless
</pre></div></div>
</div>
</section>
<section id="Work-In-Progress-⏳">
<h2>Work In Progress ⏳<a class="headerlink" href="#Work-In-Progress-⏳" title="Link to this heading">#</a></h2>
<p>We are studying the hyper-parameters needed to converge our simulations to that of Ansys/experimentally verified results with <code class="docutils literal notranslate"><span class="pre">palace</span></code>. Once that is done, we will update this tutorial with a more comprehensive guide and native API</p>
</section>
<section id="License">
<h2>License<a class="headerlink" href="#License" title="Link to this heading">#</a></h2>
<div style="width: 100%; background-color:#3cb1c2;color:#324344;padding-left: 10px; padding-bottom: 10px; padding-right: 10px; padding-top: 5px"><h3><p>This code is a part of SQuADDS</p>
</h3><p><p>Developed by Sadman Ahmed Shanto</p>
</p><p><p>This tutorial is written by Sadman Ahmed Shanto</p>
</p><p><p>© Copyright Sadman Ahmed Shanto &amp; Eli Levenson-Falk 2025.</p>
</p><p><p>This code is licensed under the MIT License. You may obtain a copy of this license in the LICENSE.txt file in the root directory of this source tree.</p>
</p><p><p>Any modifications or derivative works of this code must retain thiscopyright notice, and modified files need to carry a notice indicatingthat they have been altered from the originals.</p>
</p></div></section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Tutorial-6_Adding_Airbridges.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial 6: Adding Airbridges</p>
      </div>
    </a>
    <a class="right-next"
       href="Tutorial-8_ML_interpolation_in_SQuADDS.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorial 8: Machine Learning with <code class="docutils literal notranslate"><span class="pre">SQuADDS</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Electrostatic-Simulation">Electrostatic Simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#For-a-qubit-claw-system">For a qubit-claw system</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Eigenmodal-Simulation">Eigenmodal Simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#For-a-qubit-cavity-system">For a qubit-cavity system</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Qubit-(with-a-junction)-and-Claw">Qubit (with a junction) and Claw</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Resonator-and-Feedline">Resonator and Feedline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#EPR-Calculations">EPR Calculations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Work-In-Progress-⏳">Work In Progress ⏳</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#License">License</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/source/tutorials/Tutorial-7_Simulate_designs_with_palace.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Sadman Ahmed Shanto &amp; Eli Levenson-Falk.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>